<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Add boundary penalties — add_boundary_penalties • prioritizr</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>


<meta property="og:title" content="Add boundary penalties — add_boundary_penalties" />

<meta property="og:description" content="Add penalties to a conservation planning problem to favor
solutions that have planning units clumped together into contiguous areas." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70466840-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70466840-4');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prioritizr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/prioritizr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/gurobi_installation.html">Gurobi Installation Guide</a>
    </li>
    <li>
      <a href="../articles/publication_record.html">Publication Record</a>
    </li>
    <li>
      <a href="../articles/saltspring.html">Salt Spring Island Tutorial</a>
    </li>
    <li>
      <a href="../articles/tasmania.html">Tasmania Tutorial</a>
    </li>
    <li>
      <a href="../articles/zones.html">Management Zones</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/prioritizr/prioritizr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add boundary penalties</h1>
    <small class="dont-index">Source: <a href='https://github.com/prioritizr/prioritizr/blob/master/R/add_boundary_penalties.R'><code>R/add_boundary_penalties.R</code></a></small>
    <div class="hidden name"><code>add_boundary_penalties.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Add penalties to a conservation planning <code><a href='problem.html'>problem</a></code> to favor
solutions that have planning units clumped together into contiguous areas.</p>
    
    </div>

    <pre class="usage"><span class='fu'>add_boundary_penalties</span>(<span class='no'>x</span>, <span class='no'>penalty</span>, <span class='kw'>edge_factor</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>0.5</span>,
  <span class='fu'><a href='number_of_zones.html'>number_of_zones</a></span>(<span class='no'>x</span>)), <span class='kw'>zones</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='fu'><a href='number_of_zones.html'>number_of_zones</a></span>(<span class='no'>x</span>)), <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code><a href='ConservationProblem-class.html'>ConservationProblem-class</a></code> object.</p></td>
    </tr>
    <tr>
      <th>penalty</th>
      <td><p><code>numeric</code> penalty that is used to scale the importance
of selecting planning units that are spatially clumped together compared
to the main problem objective (e.g. solution cost when the argument to
<code>x</code> has a minimum set objective set using
<code><a href='add_min_set_objective.html'>add_min_set_objective</a></code>). Higher <code>penalty</code> values
will return solutions with a higher degree of spatial clumping,
and smaller <code>penalty</code> values will return solutions with a smaller
degree of clumping. Note that negative <code>penalty</code> values will
return solutions that are more spread out. This parameter is equivalent to
the
<a href='http://marxan.net/downloads/uq_marxan_web_2/module2.html'>boundary length modifier (BLM)</a>
parameter in <a href='http://marxan.net'><em>Marxan</em></a>.</p></td>
    </tr>
    <tr>
      <th>edge_factor</th>
      <td><p><code>numeric</code> proportion to scale
planning unit edges (or borders) that do not have any neighboring planning
units. For example, an edge factor of <code>0.5</code> is commonly used for
planning units along the coast line. Note that this argument must have an
element for each zone in the argument to <code>x</code>.</p></td>
    </tr>
    <tr>
      <th>zones</th>
      <td><p><code>matrix</code> or <code>Matrix</code> object describing the
clumping scheme for different zones. Each row and column corresponds to a
different zone in the argument to <code>x</code>, and cell values indicate the
relative importance of clumping planning units that are allocated to
a pair of zones. Cell values along the diagonal of the matrix represent
the relative importance of clumping planning units that are allocated
to the same zone. Cell values must lay between 1 and -1, where negative
values favor solutions that spread out planning units. The default
argument to <code>zones</code> is an identity
matrix (i.e. a matrix with ones along the matrix diagonal and zeros
elsewhere), so that penalties are incurred when neighboring planning units
are not assigned to the same zone. <strong>Note that if the cells along
the matrix diagonal contain markedly lower values than cells found
elsewhere in the matrix, then the optimal solution may surround
planning units with planning units that are allocated to different zones.</strong></p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p><code>NULL</code>, <code>data.frame</code>, <code>matrix</code>, or <code>Matrix</code>
object containing the boundary data. The boundary values
correspond to the shared boundary length between different planning units
and the amount of exposed boundary length that each planning unit has
which is not shared with any other planning unit. Given a certain
<code>penalty</code> value, it is more desirable to select combinations of
planning units which do not expose larger boundaries that are shared
between different planning units. See the Details section for more
information.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code><a href='ConservationProblem-class.html'>ConservationProblem-class</a></code> object with the penalties
 added to it.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function adds penalties to a conservation planning problem
  to penalize fragmented solutions. It was is inspired by Ball <em>et al.</em>
  (2009) and Beyer <em>et al.</em> (2016). The <code>penalty</code> argument is
  equivalent to the boundary length modifier (<code>BLM</code>) used in
  <a href='http://marxan.net'><em>Marxan</em></a>. Note that this function can only
  be used to represent symmetric relationships between planning units. If
  asymmetric relationships are required, use the
  <code><a href='add_connectivity_penalties.html'>add_connectivity_penalties</a></code> function.</p>
<p>The argument to <code>data</code> can be specified in several different ways:</p>
<p></p><dl class='dl-horizontal'>
    <dt><code>NULL</code></dt><dd><p>the boundary data are automatically calculated
    using the <code><a href='boundary_matrix.html'>boundary_matrix</a></code> function. This argument is the
    default. Note that the boundary data must be manually defined
    using one of the other formats below when the planning unit data
    in the argument to <code>x</code> is not spatially referenced (e.g.
    in <code>data.frame</code> or <code>numeric</code> format).</p></dd>
    <dt><code>matrix</code>, <code>Matrix</code></dt><dd><p>where rows and columns represent
    different planning units and the value of each cell represents the
    amount of shared boundary length between two different planning units.
    Cells that occur along the matrix diagonal represent the amount of
    exposed boundary associated with each planning unit that has
    no neighbor (e.g. these value might pertain the length of coastline
    in a planning unit).</p></dd>
    <dt><code>data.frame</code></dt><dd><p>containing the columns <code>"id1"</code>,
    <code>"id2"</code>, and <code>"boundary"</code>. The values in the column
    <code>"boundary"</code> show the total amount of shared boundary between the
    two planning units indicated the columns <code>"id1"</code> and <code>"id2"</code>.
    This format follows the the standard <em>Marxan</em> input format. Note
    that this function requires symmetric boundary data, and so the
    argument to <code>data</code> cannot have the columns <code>"zone1"</code> and
    code"zone2" to specify different amounts of shared boundary lengths
    for different zones. Instead, when dealing with problems with multiple
    zones, the argument to <code>zones</code> should be used to control the
    relative importance of spatially clumping planning units together when
    they are allocated to different zones.</p></dd>
    </dl>
    <p>The boundary penalties are calculated using the following equations. Let
  \(I\) represent the set of planning units
  (indexed by \(i\) or \(j\)), \(Z\) represent
  the set of management zones (indexed by \(z\) or \(y\)), and
  \(X_{iz}\) represent the decision
  variable for planning unit \(i\) for in zone \(z\) (e.g. with binary
  values one indicating if planning unit is allocated or not). Also, let
  \(p\) represent the argument to <code>penalty</code>, \(E\) represent the
  argument to <code>edge_factor</code>, \(B\) represent the matrix argument to
  <code>data</code> (e.g. generated using <code><a href='boundary_matrix.html'>boundary_matrix</a></code>), and
  \(W\) represent the matrix argument to <code>zones</code>.</p>
<p>$$
  \sum_{i}^{I} \sum_{j}^{I} \sum_{z}^{Z} (\mathit{ifelse}(i == j, E_z, 1)
  \times p \times W_{zz} B_{ij}) + \sum_{i}^{I} \sum_{j}^{I} \sum_{z}^{Z}
  \sum_{y}^{Z} (-2 \times p \times X_{iz} \times X_{jy} \times W_{zy} \times
  B_{ij})$$</p>
<p>Note that when the problem objective is to maximize some measure of
 benefit and not minimize some measure of cost, the term \(p\) is
 replaced with \(-p\).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ball IR, Possingham HP, and Watts M (2009) <em>Marxan and relatives:
Software for spatial conservation prioritisation</em> in Spatial conservation
prioritisation: Quantitative methods and computational tools. Eds Moilanen
A, Wilson KA, and Possingham HP. Oxford University Press, Oxford, UK.</p>
<p>Beyer HL, Dujardin Y, Watts ME, and Possingham HP (2016) Solving
conservation planning problems with integer linear programming.
<em>Ecological Modelling</em>, 228: 14--22.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='penalties.html'>penalties</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># set seed for reproducibility</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>500</span>)

<span class='co'># load data</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>sim_pu_raster</span>, <span class='no'>sim_features</span>, <span class='no'>sim_pu_zones_stack</span>, <span class='no'>sim_features_zones</span>)

<span class='co'># create minimal problem</span>
<span class='no'>p1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='problem.html'>problem</a></span>(<span class='no'>sim_pu_raster</span>, <span class='no'>sim_features</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_min_set_objective.html'>add_min_set_objective</a></span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_relative_targets.html'>add_relative_targets</a></span>(<span class='fl'>0.2</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_binary_decisions.html'>add_binary_decisions</a></span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_default_solver.html'>add_default_solver</a></span>()

<span class='co'># create problem with low boundary penalties</span>
<span class='no'>p2</span> <span class='kw'>&lt;-</span> <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>50</span>, <span class='fl'>1</span>)

<span class='co'># create problem with high boundary penalties but outer edges receive</span>
<span class='co'># half the penalty as inner edges</span>
<span class='no'>p3</span> <span class='kw'>&lt;-</span> <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>500</span>, <span class='fl'>0.5</span>)

<span class='co'># create a problem using precomputed boundary data</span>
<span class='no'>bmat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='boundary_matrix.html'>boundary_matrix</a></span>(<span class='no'>sim_pu_raster</span>)
<span class='no'>p4</span> <span class='kw'>&lt;-</span> <span class='no'>p1</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>50</span>, <span class='fl'>1</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>bmat</span>)</div><div class='input'><span class='co'># solve problems</span>
<span class='no'>s</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/stack'>stack</a></span>(<span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p1</span>), <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p2</span>), <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p3</span>), <span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p4</span>))</div><div class='output co'>#&gt; Optimize a model with 5 rows, 90 columns and 450 nonzeros
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 9e-01]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 2e+01]
#&gt; Found heuristic solution: objective 4925.2167415
#&gt; Presolve time: 0.00s
#&gt; Presolved: 5 rows, 90 columns, 450 nonzeros
#&gt; Variable types: 0 continuous, 90 integer (90 binary)
#&gt; Presolved: 5 rows, 90 columns, 450 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 3.942215e+03, 15 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 3942.21463    0    5 4925.21674 3942.21463  20.0%     -    0s
#&gt; H    0     0                    4032.8009877 3942.21463  2.25%     -    0s
#&gt; 
#&gt; Explored 1 nodes (15 simplex iterations) in 0.00 seconds
#&gt; Thread count was 1 (of 16 available processors)
#&gt; 
#&gt; Solution count 2: 4032.8 4925.22 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 4.032800987722e+03, best bound 3.942214626580e+03, gap 2.2462%
#&gt; Optimize a model with 289 rows, 232 columns and 1018 nonzeros
#&gt; Variable types: 0 continuous, 232 integer (232 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 2e+01]
#&gt; Found heuristic solution: objective 18823.430551
#&gt; Found heuristic solution: objective 5065.2167415
#&gt; Presolve time: 0.00s
#&gt; Presolved: 289 rows, 232 columns, 1018 nonzeros
#&gt; Variable types: 0 continuous, 232 integer (232 binary)
#&gt; Presolved: 289 rows, 232 columns, 1018 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 4.076030e+03, 130 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 4076.02992    0  121 5065.21674 4076.02992  19.5%     -    0s
#&gt; H    0     0                    4197.3328830 4076.02992  2.89%     -    0s
#&gt; 
#&gt; Explored 1 nodes (130 simplex iterations) in 0.00 seconds
#&gt; Thread count was 1 (of 16 available processors)
#&gt; 
#&gt; Solution count 3: 4197.33 5065.22 18823.4 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 4.197332883016e+03, best bound 4.076029918561e+03, gap 2.8900%
#&gt; Optimize a model with 289 rows, 232 columns and 1018 nonzeros
#&gt; Variable types: 0 continuous, 232 integer (232 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+02, 4e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 2e+01]
#&gt; Found heuristic solution: objective 20343.430551
#&gt; Found heuristic solution: objective 5900.2167415
#&gt; Presolve time: 0.00s
#&gt; Presolved: 289 rows, 232 columns, 1018 nonzeros
#&gt; Variable types: 0 continuous, 232 integer (232 binary)
#&gt; Presolved: 289 rows, 232 columns, 1018 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 4.508412e+03, 153 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 4508.41204    0  198 5900.21674 4508.41204  23.6%     -    0s
#&gt;      0     0 4573.19307    0  206 5900.21674 4573.19307  22.5%     -    0s
#&gt;      0     0 4574.56143    0  211 5900.21674 4574.56143  22.5%     -    0s
#&gt;      0     0 4600.21906    0  179 5900.21674 4600.21906  22.0%     -    0s
#&gt; H    0     0                    5730.5624609 4600.21906  19.7%     -    0s
#&gt;      0     0 4609.96329    0  190 5730.56246 4609.96329  19.6%     -    0s
#&gt;      0     0 4610.19478    0  190 5730.56246 4610.19478  19.6%     -    0s
#&gt;      0     0 4610.54375    0  190 5730.56246 4610.54375  19.5%     -    0s
#&gt;      0     0 4610.54375    0  190 5730.56246 4610.54375  19.5%     -    0s
#&gt; H    0     0                    5597.3170396 4610.54375  17.6%     -    0s
#&gt; H    0     0                    5582.4891424 4610.54375  17.4%     -    0s
#&gt; H    0     0                    5506.6808974 4610.54375  16.3%     -    0s
#&gt;      0     2 4611.79703    0  190 5506.68090 4611.79703  16.3%     -    0s
#&gt; H   27    26                    5248.2177384 4611.79703  12.1%  13.7    0s
#&gt; H   82    52                    5162.4230578 4669.58495  9.55%  14.5    0s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 5
#&gt; 
#&gt; Explored 82 nodes (1444 simplex iterations) in 0.11 seconds
#&gt; Thread count was 1 (of 16 available processors)
#&gt; 
#&gt; Solution count 8: 5162.42 5248.22 5506.68 ... 20343.4
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 5.162423057801e+03, best bound 4.669584952762e+03, gap 9.5466%
#&gt; Optimize a model with 289 rows, 232 columns and 1018 nonzeros
#&gt; Variable types: 0 continuous, 232 integer (232 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [6e+00, 2e+01]
#&gt; Found heuristic solution: objective 18823.430551
#&gt; Found heuristic solution: objective 5065.2167415
#&gt; Presolve time: 0.00s
#&gt; Presolved: 289 rows, 232 columns, 1018 nonzeros
#&gt; Variable types: 0 continuous, 232 integer (232 binary)
#&gt; Presolved: 289 rows, 232 columns, 1018 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 4.076030e+03, 130 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 4076.02992    0  121 5065.21674 4076.02992  19.5%     -    0s
#&gt; H    0     0                    4197.3328830 4076.02992  2.89%     -    0s
#&gt; 
#&gt; Explored 1 nodes (130 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 16 available processors)
#&gt; 
#&gt; Solution count 3: 4197.33 5065.22 18823.4 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 4.197332883016e+03, best bound 4.076029918561e+03, gap 2.8900%</div><div class='input'>
<span class='co'># plot solutions</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>s</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"basic solution"</span>, <span class='st'>"small penalties"</span>, <span class='st'>"high penalties"</span>,
                 <span class='st'>"precomputed data"</span>), <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_boundary_penalties-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># create minimal problem with multiple zones and limit the run-time for</span>
<span class='co'># solver to 10 seconds so this example doesn't take too long</span>
<span class='no'>p5</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='problem.html'>problem</a></span>(<span class='no'>sim_pu_zones_stack</span>, <span class='no'>sim_features_zones</span>) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_min_set_objective.html'>add_min_set_objective</a></span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_relative_targets.html'>add_relative_targets</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fl'>0.2</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>)) <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_binary_decisions.html'>add_binary_decisions</a></span>() <span class='kw'>%&gt;%</span>
      <span class='fu'><a href='add_default_solver.html'>add_default_solver</a></span>(<span class='kw'>time_limit</span> <span class='kw'>=</span> <span class='fl'>10</span>)

<span class='co'># create zone matrix which favors clumping planning units that are</span>
<span class='co'># allocated to the same zone together - note that this is the default</span>
<span class='no'>zm6</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='fl'>3</span>)
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm6</span>)</div><div class='output co'>#&gt;      [,1] [,2] [,3]
#&gt; [1,]    1    0    0
#&gt; [2,]    0    1    0
#&gt; [3,]    0    0    1</div><div class='input'>
<span class='co'># create problem with the zone matrix and low penalties</span>
<span class='no'>p6</span> <span class='kw'>&lt;-</span> <span class='no'>p5</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>50</span>, <span class='kw'>zone</span> <span class='kw'>=</span> <span class='no'>zm6</span>)

<span class='co'># create another problem with the same zone matrix and higher penalties</span>
<span class='no'>p7</span> <span class='kw'>&lt;-</span> <span class='no'>p5</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>500</span>, <span class='kw'>zone</span> <span class='kw'>=</span> <span class='no'>zm6</span>)

<span class='co'># create zone matrix which favors clumping units that are allocated to</span>
<span class='co'># different zones together</span>
<span class='no'>zm8</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fl'>1</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='no'>zm8</span>) <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm8</span>)</div><div class='output co'>#&gt;      [,1] [,2] [,3]
#&gt; [1,]    0    1    1
#&gt; [2,]    1    0    1
#&gt; [3,]    1    1    0</div><div class='input'>
<span class='co'># create problem with the zone matrix</span>
<span class='no'>p8</span> <span class='kw'>&lt;-</span> <span class='no'>p5</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>500</span>, <span class='kw'>zone</span> <span class='kw'>=</span> <span class='no'>zm8</span>)

<span class='co'># create zone matrix which strongly favors clumping units</span>
<span class='co'># that are allocated to the same zone together. It will also prefer</span>
<span class='co'># clumping planning units in zones 1 and 2 together over having</span>
<span class='co'># these planning units with no neighbors in the solution</span>
<span class='no'>zm9</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='fl'>3</span>)
<span class='no'>zm9</span>[<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/lower.tri'>upper.tri</a></span>(<span class='no'>zm9</span>)] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0.3</span>, <span class='fl'>0</span>, <span class='fl'>0</span>)
<span class='no'>zm9</span>[<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/lower.tri'>lower.tri</a></span>(<span class='no'>zm9</span>)] <span class='kw'>&lt;-</span> <span class='no'>zm9</span>[<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/lower.tri'>upper.tri</a></span>(<span class='no'>zm9</span>)]
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm9</span>)</div><div class='output co'>#&gt;      [,1] [,2] [,3]
#&gt; [1,]  1.0  0.3    0
#&gt; [2,]  0.3  1.0    0
#&gt; [3,]  0.0  0.0    1</div><div class='input'>
<span class='co'># create problem with the zone matrix</span>
<span class='no'>p9</span> <span class='kw'>&lt;-</span> <span class='no'>p5</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>500</span>, <span class='kw'>zone</span> <span class='kw'>=</span> <span class='no'>zm9</span>)

<span class='co'># create zone matrix which favors clumping planning units in zones 1 and 2</span>
<span class='co'># together, and favors planning units in zone 3 being spread out</span>
<span class='co'># (i.e. negative clumping)</span>
<span class='no'>zm10</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='fl'>3</span>)
<span class='no'>zm10</span>[<span class='fl'>3</span>, <span class='fl'>3</span>] <span class='kw'>&lt;-</span> -<span class='fl'>1</span>
<span class='fu'><a href='print.html'>print</a></span>(<span class='no'>zm10</span>)</div><div class='output co'>#&gt;      [,1] [,2] [,3]
#&gt; [1,]    1    0    0
#&gt; [2,]    0    1    0
#&gt; [3,]    0    0   -1</div><div class='input'>
<span class='co'># create problem with the zone matrix</span>
<span class='no'>p10</span> <span class='kw'>&lt;-</span> <span class='no'>p5</span> <span class='kw'>%&gt;%</span> <span class='fu'>add_boundary_penalties</span>(<span class='fl'>500</span>, <span class='kw'>zone</span> <span class='kw'>=</span> <span class='no'>zm10</span>)</div><div class='input'><span class='co'># solve problems</span>
<span class='no'>s2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/stack'>stack</a></span>(<span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p5</span>)), <span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p6</span>)),
            <span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p7</span>)), <span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p8</span>)),
            <span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p9</span>)), <span class='fu'><a href='category_layer.html'>category_layer</a></span>(<span class='fu'><a href='solve.html'>solve</a></span>(<span class='no'>p10</span>)))</div><div class='output co'>#&gt; Optimize a model with 105 rows, 270 columns and 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [2e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 12472.388222
#&gt; Presolve time: 0.00s
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; Variable types: 0 continuous, 270 integer (270 binary)
#&gt; Presolved: 105 rows, 270 columns, 1620 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 1.177187e+04, 157 iterations, 0.00 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 11771.8653    0   19 12472.3882 11771.8653  5.62%     -    0s
#&gt; 
#&gt; Explored 1 nodes (157 simplex iterations) in 0.01 seconds
#&gt; Thread count was 1 (of 16 available processors)
#&gt; 
#&gt; Solution count 1: 12472.4 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 1.247238822194e+04, best bound 1.177186533844e+04, gap 5.6166%
#&gt; Optimize a model with 957 rows, 696 columns and 3324 nonzeros
#&gt; Variable types: 0 continuous, 696 integer (696 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+01, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 13344.888222
#&gt; Presolve time: 0.01s
#&gt; Presolved: 957 rows, 696 columns, 3324 nonzeros
#&gt; Variable types: 0 continuous, 696 integer (696 binary)
#&gt; Presolved: 957 rows, 696 columns, 3324 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 1.204778e+04, 591 iterations, 0.02 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 12047.7762    0  478 13344.8882 12047.7762  9.72%     -    0s
#&gt; 
#&gt; Explored 1 nodes (591 simplex iterations) in 0.03 seconds
#&gt; Thread count was 1 (of 16 available processors)
#&gt; 
#&gt; Solution count 1: 13344.9 
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 1.334488822194e+04, best bound 1.204777624593e+04, gap 9.7199%
#&gt; Optimize a model with 957 rows, 696 columns and 3324 nonzeros
#&gt; Variable types: 0 continuous, 696 integer (696 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+02, 4e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 21197.388222
#&gt; Presolve time: 0.01s
#&gt; Presolved: 957 rows, 696 columns, 3324 nonzeros
#&gt; Variable types: 0 continuous, 696 integer (696 binary)
#&gt; Presolved: 957 rows, 696 columns, 3324 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 1.332836e+04, 677 iterations, 0.02 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 13328.3590    0  594 21197.3882 13328.3590  37.1%     -    0s
#&gt; H    0     0                    20023.927571 13328.3590  33.4%     -    0s
#&gt;      0     0 13446.3513    0  614 20023.9276 13446.3513  32.8%     -    0s
#&gt; H    0     0                    19387.611366 13446.3513  30.6%     -    0s
#&gt; H    0     0                    19135.660219 13446.3513  29.7%     -    0s
#&gt;      0     0 13497.0596    0  604 19135.6602 13497.0596  29.5%     -    0s
#&gt;      0     0 13497.2361    0  602 19135.6602 13497.2361  29.5%     -    0s
#&gt;      0     0 13516.3747    0  610 19135.6602 13516.3747  29.4%     -    0s
#&gt;      0     0 13517.4436    0  633 19135.6602 13517.4436  29.4%     -    0s
#&gt;      0     0 13517.4436    0  633 19135.6602 13517.4436  29.4%     -    0s
#&gt; H    0     0                    17809.248949 13517.4436  24.1%     -    0s
#&gt;      0     2 13518.4917    0  633 17809.2489 13518.4917  24.1%     -    0s
#&gt; H   66    66                    16493.556872 13521.2552  18.0%  31.5    0s
#&gt; H  276   188                    16209.554817 13612.6466  16.0%  24.1    0s
#&gt; H  524   386                    15910.617013 13668.1385  14.1%  21.5    2s
#&gt; H  524   366                    15827.318210 13668.1385  13.6%  21.5    2s
#&gt; H  552   366                    15772.580126 13747.8697  12.8%  29.4    2s
#&gt; H  877   528                    15755.459825 13793.1723  12.5%  32.4    3s
#&gt; H 1083   524                    15596.503243 13836.3302  11.3%  36.7    4s
#&gt;   1388   639 14048.3968   13  603 15596.5032 13881.6838  11.0%  37.9    5s
#&gt; H 1585   763                    15569.230972 13908.8588  10.7%  39.8    5s
#&gt; H 1791   846                    15497.215743 13938.8652  10.1%  39.9    6s
#&gt; H 1903   866                    15413.226933 13943.3042  9.54%  40.7    6s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 17
#&gt; 
#&gt; Explored 1903 nodes (78392 simplex iterations) in 6.77 seconds
#&gt; Thread count was 1 (of 16 available processors)
#&gt; 
#&gt; Solution count 10: 15413.2 15497.2 15569.2 ... 16493.6
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 1.541322693282e+04, best bound 1.394330416426e+04, gap 9.5368%
#&gt; Optimize a model with 1809 rows, 1122 columns and 5028 nonzeros
#&gt; Variable types: 0 continuous, 1122 integer (1122 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [1e+02, 2e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 7872.3882219
#&gt; Presolve time: 0.02s
#&gt; Presolved: 1809 rows, 1122 columns, 6732 nonzeros
#&gt; Variable types: 0 continuous, 1122 integer (1122 binary)
#&gt; Presolve removed 852 rows and 0 columns
#&gt; Presolved: 957 rows, 1122 columns, 4176 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 2.180517e+03, 1028 iterations, 0.02 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 2180.51718    0  310 7872.38822 2180.51718  72.3%     -    0s
#&gt; H    0     0                    3685.3269817 2180.51718  40.8%     -    0s
#&gt; H    0     0                    3491.0747273 2180.51718  37.5%     -    0s
#&gt; H    0     0                    2606.8062079 2180.51718  16.4%     -    0s
#&gt;      0     0 2216.80838    0  387 2606.80621 2216.80838  15.0%     -    0s
#&gt; H    0     0                    2606.1574891 2216.80838  14.9%     -    0s
#&gt;      0     0 2218.64653    0  325 2606.15749 2218.64653  14.9%     -    0s
#&gt; H    0     0                    2510.2394922 2218.64653  11.6%     -    0s
#&gt;      0     0 2218.64653    0  326 2510.23949 2218.64653  11.6%     -    0s
#&gt;      0     0 2218.66119    0  388 2510.23949 2218.66119  11.6%     -    0s
#&gt;      0     0 2218.66119    0  388 2510.23949 2218.66119  11.6%     -    0s
#&gt; H    0     0                    2314.4401664 2218.66119  4.14%     -    0s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 2
#&gt;   Zero half: 2
#&gt; 
#&gt; Explored 1 nodes (1677 simplex iterations) in 0.32 seconds
#&gt; Thread count was 1 (of 16 available processors)
#&gt; 
#&gt; Solution count 7: 2314.44 2510.24 2606.16 ... 7872.39
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 2.314440166383e+03, best bound 2.218661192987e+03, gap 4.1383%
#&gt; Optimize a model with 1525 rows, 980 columns and 4460 nonzeros
#&gt; Variable types: 0 continuous, 980 integer (980 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [3e+01, 4e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 20807.388222
#&gt; Presolve time: 0.01s
#&gt; Presolved: 1525 rows, 980 columns, 5596 nonzeros
#&gt; Variable types: 0 continuous, 980 integer (980 binary)
#&gt; Presolve removed 568 rows and 0 columns
#&gt; Presolved: 957 rows, 980 columns, 3892 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 1.332836e+04, 719 iterations, 0.02 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 13328.3590    0  594 20807.3882 13328.3590  35.9%     -    0s
#&gt; H    0     0                    19562.771486 13328.3590  31.9%     -    0s
#&gt; H    0     0                    18843.191064 13328.3590  29.3%     -    0s
#&gt;      0     0 13421.4069    0  602 18843.1911 13421.4069  28.8%     -    0s
#&gt;      0     0 13433.9115    0  608 18843.1911 13433.9115  28.7%     -    0s
#&gt;      0     0 13510.7331    0  624 18843.1911 13510.7331  28.3%     -    0s
#&gt;      0     0 13525.4949    0  633 18843.1911 13525.4949  28.2%     -    0s
#&gt;      0     0 13525.6731    0  616 18843.1911 13525.6731  28.2%     -    0s
#&gt;      0     0 13527.1416    0  613 18843.1911 13527.1416  28.2%     -    0s
#&gt; H    0     0                    18355.687841 13527.1416  26.3%     -    0s
#&gt;      0     0 13527.1416    0  613 18355.6878 13527.1416  26.3%     -    0s
#&gt; H    0     0                    16420.418865 13527.1416  17.6%     -    0s
#&gt; H    0     0                    15799.973146 13527.1416  14.4%     -    0s
#&gt;      0     2 13528.1820    0  613 15799.9731 13528.1820  14.4%     -    0s
#&gt; H   81    70                    15703.628653 13584.8417  13.5%  40.8    0s
#&gt; H  109    91                    15612.437092 13584.8417  13.0%  44.2    1s
#&gt; H  654   457                    15553.759963 13756.8191  11.6%  45.0    3s
#&gt; H  656   440                    15552.221585 13756.8191  11.5%  44.9    3s
#&gt; H  737   463                    15546.944599 13756.8191  11.5%  49.6    4s
#&gt;    947   555 15433.6036   97    8 15546.9446 13828.3684  11.1%  49.5    5s
#&gt; H 1173   545                    15498.743547 13836.9531  10.7%  46.8    5s
#&gt; H 1637   714                    15431.832590 13893.5628  10.0%  51.8    7s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 9
#&gt;   Zero half: 1
#&gt; 
#&gt; Explored 1637 nodes (86008 simplex iterations) in 7.31 seconds
#&gt; Thread count was 1 (of 16 available processors)
#&gt; 
#&gt; Solution count 10: 15431.8 15498.7 15546.9 ... 18355.7
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 1.543183258997e+04, best bound 1.389356283664e+04, gap 9.9682%
#&gt; Optimize a model with 1099 rows, 696 columns and 3750 nonzeros
#&gt; Variable types: 0 continuous, 696 integer (696 binary)
#&gt; Coefficient statistics:
#&gt;   Matrix range     [2e-01, 1e+00]
#&gt;   Objective range  [6e-02, 4e+02]
#&gt;   Bounds range     [1e+00, 1e+00]
#&gt;   RHS range        [1e+00, 2e+01]
#&gt; Found heuristic solution: objective 14542.817737
#&gt; Presolve time: 0.01s
#&gt; Presolved: 1099 rows, 696 columns, 3892 nonzeros
#&gt; Variable types: 0 continuous, 696 integer (696 binary)
#&gt; Presolved: 1099 rows, 696 columns, 3892 nonzeros
#&gt; 
#&gt; 
#&gt; Root relaxation: objective 9.091249e+03, 524 iterations, 0.01 seconds
#&gt; 
#&gt;     Nodes    |    Current Node    |     Objective Bounds      |     Work
#&gt;  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
#&gt; 
#&gt;      0     0 9091.24942    0  445 14542.8177 9091.24942  37.5%     -    0s
#&gt; H    0     0                    13862.013049 9091.24942  34.4%     -    0s
#&gt;      0     0 9196.50523    0  467 13862.0130 9196.50523  33.7%     -    0s
#&gt; H    0     0                    13805.895213 9196.50523  33.4%     -    0s
#&gt;      0     0 9211.61907    0  468 13805.8952 9211.61907  33.3%     -    0s
#&gt; H    0     0                    13271.081625 9211.61907  30.6%     -    0s
#&gt;      0     0 9250.72764    0  479 13271.0816 9250.72764  30.3%     -    0s
#&gt;      0     0 9251.74324    0  478 13271.0816 9251.74324  30.3%     -    0s
#&gt;      0     0 9261.26725    0  505 13271.0816 9261.26725  30.2%     -    0s
#&gt; H    0     0                    13065.013951 9261.26725  29.1%     -    0s
#&gt;      0     0 9262.20629    0  496 13065.0140 9262.20629  29.1%     -    0s
#&gt;      0     0 9262.87842    0  495 13065.0140 9262.87842  29.1%     -    0s
#&gt; H    0     0                    13039.301361 9262.87842  29.0%     -    0s
#&gt;      0     0 9263.95743    0  495 13039.3014 9263.95743  29.0%     -    0s
#&gt;      0     0 9264.60922    0  494 13039.3014 9264.60922  28.9%     -    0s
#&gt;      0     0 9272.60541    0  495 13039.3014 9272.60541  28.9%     -    0s
#&gt;      0     0 9274.83975    0  494 13039.3014 9274.83975  28.9%     -    0s
#&gt;      0     0 9274.84266    0  494 13039.3014 9274.84266  28.9%     -    0s
#&gt;      0     0 9275.59639    0  493 13039.3014 9275.59639  28.9%     -    0s
#&gt;      0     0 9276.81347    0  503 13039.3014 9276.81347  28.9%     -    0s
#&gt;      0     0 9276.81347    0  503 13039.3014 9276.81347  28.9%     -    0s
#&gt; H    0     0                    12045.123276 9276.81347  23.0%     -    0s
#&gt; H    0     0                    11829.020240 9276.81347  21.6%     -    0s
#&gt; H    0     0                    11824.542705 9276.81347  21.5%     -    0s
#&gt; H    0     0                    11765.762527 9276.81347  21.2%     -    1s
#&gt;      0     2 9276.94322    0  503 11765.7625 9276.94322  21.2%     -    1s
#&gt; H   54    54                    11276.551026 9277.02733  17.7%  40.1    1s
#&gt; H   81    51                    11006.121326 9277.02733  15.7%  29.3    1s
#&gt; H  429   332                    10962.939145 9424.53773  14.0%  30.8    1s
#&gt; H  607   422                    10839.711418 9509.14151  12.3%  39.4    3s
#&gt; H  742   478                    10811.918589 9524.38470  11.9%  41.3    4s
#&gt;    958   536 9887.60011   22  378 10811.9186 9551.13567  11.7%  43.0    5s
#&gt; H 1403   640                    10723.005167 9610.84024  10.4%  43.6    5s
#&gt; H 1419   579                    10699.648479 9610.84024  10.2%  43.4    5s
#&gt; 
#&gt; Cutting planes:
#&gt;   Gomory: 13
#&gt; 
#&gt; Explored 1463 nodes (63110 simplex iterations) in 5.99 seconds
#&gt; Thread count was 1 (of 16 available processors)
#&gt; 
#&gt; Solution count 10: 10699.6 10723 10811.9 ... 11829
#&gt; 
#&gt; Optimal solution found (tolerance 1.00e-01)
#&gt; Best objective 1.069964847916e+04, best bound 9.630805781448e+03, gap 9.9895%</div><div class='input'>
<span class='co'># plot solutions</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>s2</span>, <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"basic solution"</span>, <span class='st'>"within zone clumping (low)"</span>,
                  <span class='st'>"within zone clumping (high)"</span>, <span class='st'>"between zone clumping"</span>,
                  <span class='st'>"within + between clumping"</span>, <span class='st'>"negative clumping"</span>),
     <span class='kw'>axes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>box</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='add_boundary_penalties-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://jeffrey-hanson.com'>Jeffrey O Hanson</a>, <a href='http://www.richard-schuster.com/'>Richard Schuster</a>, Nina Morrell, <a href='http://strimas.com'>Matthew Strimas-Mackey</a>, Matthew E Watts, <a href='https://arcese.forestry.ubc.ca'>Peter Arcese</a>, <a href='https://josephrbennett.wordpress.com/'>Joeseph Bennett</a>, Hugh P Possingham.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '486efa122ea6783724263412c5f28ab3',
    indexName: 'prioritizr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>


  </body>
</html>

